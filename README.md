# Прогнозирование температуры поверхности звёзд с помощью нейронной сети

## Описание проекта

Этот проект посвящён предсказанию температуры поверхности звёзд с использованием нейронной сети на основе данных, предоставленных обсерваторией «Небо на ладони». Набор данных содержит характеристики 240 звёзд, включая числовые параметры (относительная светимость, радиус, абсолютная звёздная величина) и категориальные признаки (цвет звезды, тип звезды). Цель проекта — разработать точную и надёжную регрессионную модель для оценки температуры поверхности звёзд (в Кельвинах) с метрикой RMSE ниже 4500 К, превосходящую базовую модель и демонстрирующую стабильные результаты на тестовой выборке.

### Цели проекта
- Провести исследовательский анализ данных (EDA) для выявления корреляций и выбросов.
- Подготовить данные: обработать категориальные признаки, масштабировать числовые, разделить на обучающую и тестовую выборки.
- Построить и оценить базовую модель нейронной сети.
- Оптимизировать модель с помощью подбора гиперпараметров (размер батча, Dropout и др.).
- Сравнить модели и сделать выводы о применимости нейронных сетей в задачах спектральной астрономии.

## Описание данных

Данные содержат следующие признаки:

- **L/Lo**: Относительная светимость звезды относительно Солнца.
- **R/Ro**: Относительный радиус звезды относительно радиуса Солнца.
- **Mv**: Абсолютная звёздная величина (блеск звезды).
- **Color**: Цвет звезды (например, red, yellow-orange, blue и др.).
- **Type**: Тип звезды (от 0 до 5, например, красный карлик, сверхгигант и др.).
- **T(K)**: Температура звезды в Кельвинах — целевой признак.

## Требования

- Python 3.9+
- Библиотеки: `numpy`, `pandas`, `torch`, `optuna`, `shap`, `scipy`, `category_encoders`, `matplotlib`, `seaborn`, `phik`, `scikit-learn`

Установка зависимостей:
```bash
pip install numpy pandas torch optuna shap scipy category_encoders matplotlib seaborn phik scikit-learn
```

## Структура проекта

- **data/**: Папка для хранения данных (например, `6_class.csv`).
- **notebooks/**: Jupyter-ноутбуки с кодом анализа и обучения моделей.
- **README.md**: Описание проекта.
- **requirements.txt**: Список зависимостей.

## Использование

1. **Клонирование репозитория**:
   ```bash
   git clone https://github.com/legonc/star-temperature-prediction.git
   cd star-temperature-prediction
   ```

2. **Установка зависимостей**:
   ```bash
   pip install -r requirements.txt
   ```

3. **Запуск ноутбука**:
   - Откройте Jupyter Notebook с кодом анализа и обучения модели.
   - Убедитесь, что данные находятся в папке `data/` или укажите путь к файлу `6_class.csv`.

4. **Обучение модели**:
   - Базовая модель: Нейронная сеть с архитектурой 10-34-8-1, SiLU, Adam (lr=0.1), batch_size=10.
   - Оптимизированная модель: Подбор гиперпараметров через Optuna (dropout, lr, weight_decay, batch_size, epochs).

5. **Оценка результатов**:
   - Метрика: RMSE.
   - Целевая точность: RMSE < 4500 К.
   - SHAP-анализ для интерпретации важности признаков.

## Результаты

### Базовая модель
- **Архитектура**: 10-34-8-1, SiLU, Dropout (p=0.1).
- **Гиперпараметры**: lr=0.1, batch_size=10, epochs=400, patience=70.
- **RMSE**: 3858.59 К (цель достигнута).
- **Проблемы**: Переоценка/недооценка температуры для звёзд с высокой/средней температурой.

### Оптимизированная модель
- **Архитектура**: 10-34-8-1, SiLU, Dropout.
- **Гиперпараметры**: Подобраны через Optuna (lr=0.0632, batch_size=8, epochs=124, weight_decay=0.000365, dropout=0.473, patience=30).
- **RMSE**: 3558.14 К (улучшение на ~7.7% по сравнению с бейзлайном).
- **Преимущества**: Более точные предсказания, меньший разброс ошибок.

### Интерпретация
- **SHAP-анализ**: Ключевые признаки — `star_type`, `luminosity_l_lo`, `star_color_red`.
- **Вывод**: Модель эффективно использует тип звезды, светимость и цвет для предсказаний.

## Ограничения и рекомендации

### Ограничения
- Малый объём данных (240 записей) ограничивает сложность модели.
- Стохастичность Dropout и инициализация весов приводят к вариациям RMSE (~3500–3600 К).
- Невозможность полной воспроизводимости без сохранения модели (например, через `torch.save`).

### Рекомендации
- Сохранять модель с помощью `torch.save` для воспроизводимости.
- Добавить синтетические признаки на основе физических законов (Вина, Стефана-Больцмана).
- Исключить шумные признаки (например, `radius_r_ro`).
- Использовать кросс-валидацию и ансамбли для повышения стабильности.

## Заключение

Оптимизированная модель с RMSE 3558.14 К демонстрирует высокую точность и стабильность, подтверждая применимость нейронных сетей в задачах спектральной астрономии. Проект может быть интегрирован в системы обработки телескопических данных. Дальнейшая работа с данными и сохранение моделей повысят воспроизводимость и производительность.